---
import { CollectionEntry, getCollection } from 'astro:content';
import Command from '../../components/command.astro';
import Link from '../../components/link.astro';
import Prose from '../../components/prose.astro';
import Base from '../../layouts/base.astro';

export async function getStaticPaths() {
    const projectEntries = await getCollection('projects');
    return projectEntries.map((entry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }));
}

interface Props {
    entry: CollectionEntry<'projects'>;
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Base title={`${entry.data.title} - rileyflynn.me`}>
    <Command command={`kubectl describe project ${entry.slug}`} />
    Name: {entry.data.title}<br />
    Summary: {entry.data.summary}<br />

    <br />

    {
        entry.data.links.map((link) => (
            <>
                <Command command={`kubectl describe service ${entry.slug}-${link.label.toLowerCase()}`} />
                Name: {link.label}
                <br />
                Endpoints: <Link href={link.url} text={link.url} />
                <br />
                <br />
            </>
        ))
    }

    {
        entry.body && (
            <>
                <Command command={`kubectl get project ${entry.slug} --output=markdown`} />
                <Prose>
                    <Content />
                </Prose>
            </>
        )
    }
</Base>
